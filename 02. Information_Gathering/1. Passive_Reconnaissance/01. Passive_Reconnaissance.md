<h1 align="center"> Passive Reconnaissance </h1>

<img width="1098" height="258" alt="image" src="https://github.com/user-attachments/assets/edf34ca6-7a1e-46c4-9513-c46f4d0dc91c" />

- Lab URL: https://tryhackme.com/room/passiverecon





## Task 1: Introduction 
<img width="1080" height="831" alt="image" src="https://github.com/user-attachments/assets/f0ad48d9-076a-44d0-b098-a2ebbf1f60ec" />


## Task 2: Passive Versus Active Recon:
<img width="818" height="933" alt="image" src="https://github.com/user-attachments/assets/efbc872b-36a0-4f17-9575-4f70f3edb735" />

Reconnaissance (recon) can be defined as a preliminary survey to gather information about a target. It is the first step in The Unified Kill Chain to gain an initial foothold on a system. We divide reconnaissance into:
  - Passive Reconnaissance
  - Active Reconnaissance


Passive reconnaissance activities include many activities, for instance:
  - Looking up DNS records of a domain from a public DNS server.
  - Checking job ads related to the target website.
  - Reading news articles about the target company.

Active reconnaissance, on the other hand, cannot be achieved so discreetly. It requires direct engagement with the target. Think of it like you check the locks on the doors and windows, among other potential entry points.


<img width="1294" height="417" alt="image" src="https://github.com/user-attachments/assets/2c918ddc-113a-40c2-9356-30a22b28bf35" />


###
#### Question 1: You visit the Facebook page of the target company, hoping to get some of their employee names. What kind of reconnaissance activity is this? (A for active, P for passive)
````
P
````
#### Question 2: You ping the IP address of the company webserver to check if ICMP traffic is blocked. What kind of reconnaissance activity is this? (A for active, P for passive)
````
A
````
#### You happen to meet the IT administrator of the target company at a party. You try to use social engineering to get more information about their systems and network infrastructure. What kind of reconnaissance activity is this? (A for active, P for passive)
````
A
````
<img width="1670" height="523" alt="image" src="https://github.com/user-attachments/assets/1edd645b-483b-4731-8deb-65dd39c9cf89" />



## Task 3: Whois
WHOIS Protocol Summary
 • Specification: WHOIS follows RFC 3912.
 • Port: WHOIS servers listen on TCP port 43.
 • Responsibility: Domain registrars maintain WHOIS records for the domains they lease.
 • Function: WHOIS servers respond with domain-related information.
Information Retrieved via WHOIS
 • Registrar: Identifies the registrar where the domain was registered.
 • Registrant Contact Info: Name, organization, address, phone (may be hidden by privacy services).
 • Domain Dates:
 • Creation date (when first registered)
 • Update date (last modification)
 • Expiration date (renewal deadline)
 • Name Servers: Which servers resolve the domain name.


<img width="732" height="781" alt="image" src="https://github.com/user-attachments/assets/53f98db4-0db2-447d-b838-2a3a544d996e" />

<img width="994" height="694" alt="image" src="https://github.com/user-attachments/assets/1301a130-cbf5-4f35-8e4d-a4067f2f57c2" />

<img width="926" height="495" alt="image" src="https://github.com/user-attachments/assets/cb007360-5788-4342-9217-32cdd8f34c33" />


WHOIS Inspection Summary
• Redirection: Query was redirected to whois.namecheap.com, meaning Namecheap is maintaining the WHOIS record for the domain.
• Domain Dates:
  • Creation date – when the domain was first registered
  • Last-update date – most recent modification
  • Expiration date – renewal deadline
• 	Registrar & Registrant Info:
  • Registrar details (company managing the domain)
  • Registrant’s name and contact info (may be hidden by privacy services)
  • Admin and tech contacts (not always displayed)
• Name Servers: Identifies servers to query for DNS records.


---






### Questions:
<img width="1617" height="480" alt="image" src="https://github.com/user-attachments/assets/450d9491-e359-46e6-be88-2b9864441ef2" />

#### Question 1: When was TryHackMe.com registered?
````
whois tryhackme.com
````
<img width="1002" height="591" alt="image" src="https://github.com/user-attachments/assets/18c70f23-e403-44ea-af60-b242171c2583" />

- Answer: 
````
20180705
````
<img width="1563" height="129" alt="image" src="https://github.com/user-attachments/assets/c9654bbb-74fc-43df-b922-0828bde42c5e" />


#### Question 2: What is the registrar of TryHackMe.com?

<img width="1046" height="532" alt="image" src="https://github.com/user-attachments/assets/7a9429c2-af26-4d6e-8a3d-1264271dd6f8" />

- Answer:
````
namecheap.com
````
<img width="1579" height="130" alt="image" src="https://github.com/user-attachments/assets/94899896-c603-473f-834e-d7678a3e6d7e" />


#### Question 3: Which company is TryHackMe.com using for name servers?
<img width="1002" height="576" alt="image" src="https://github.com/user-attachments/assets/06e00eb1-d1ea-4311-ac7f-c6246c7a78fe" />


- Answer:
````
CLOUDFLARE.COM
````
<img width="1581" height="146" alt="image" src="https://github.com/user-attachments/assets/f9347141-0885-433b-b178-728138a72623" />




## Task 4: nslookup and dig


### What is nslookup?
• 	Definition: Stands for Name Server Look Up.
• 	Purpose: Queries DNS servers to resolve domain names into IP addresses.
• 	Use Case: Helps you find the IPv4/IPv6 address of a domain, check DNS records, or troubleshoot DNS issues.

#### Syntax:
````
nslookup [OPTIONS] DOMAIN_NAME [SERVER]
````

- OPTIONS → Query type (e.g., `A` for IPv4, `AAAA` for IPv6, `MX` for mail servers).
- DOMAIN_NAME → The domain you want to resolve (e.g., `tryhackme.com`).
- SERVER → The DNS server to query (optional). Examples:
- Cloudflare → `1.1.1.1` or `1.0.0.1`
- Google → `8.8.8.8` or `8.8.4.4`
- Quad9 → `9.9.9.9` or `149.112.112.112`


#### Basic IPv4 lookup:
````
nslookup tryhackme.com
````
<img width="424" height="309" alt="image" src="https://github.com/user-attachments/assets/747fd42e-dd6c-457e-8cf2-8fb08c374cf7" />

- Returns the IPv4 address of `tryhackme.com` using your default DNS server.


#### Explicit IPv4 query (A record):
````
nslookup -type=A tryhackme.com
````
<img width="409" height="224" alt="image" src="https://github.com/user-attachments/assets/108b19e2-ac5b-4ed7-8257-46b9304073e9" />



#### IPv6 query (AAAA record):
````
nslookup -type=AAAA tryhackme.com
````
<img width="439" height="236" alt="image" src="https://github.com/user-attachments/assets/5ee88112-7363-4fd2-8e8c-a28699f4cebb" />


#### Query using Google DNS:
````
nslookup tryhackme.com 8.8.8.8
````
<img width="445" height="305" alt="image" src="https://github.com/user-attachments/assets/f595c9be-3822-4962-85e5-632881b140df" />


#### case-insensitive
````
nslookup -type=A tryhackme.com 1.1.1.1
````
<img width="494" height="219" alt="image" src="https://github.com/user-attachments/assets/32b185b0-4ec6-42fd-9a29-48e960c0dc37" />



| Query Type | Result             |
| ---------- | ------------------ |
| A          | IPv4 Addresses     |
| AAAA       | IPv6 Addresses     |
| CNAME      | Canonical Name     |
| MX         | Mail Servers       |
| SOA        | Start of Authority |
| TXT        | TXT Records        |

#### **Key Takeaway
 • WHOIS gives you registrar and DNS server info, while nslookup lets you resolve the actual IP address of a domain.
 • Together, they form the recon foundation in penetration testing: WHOIS for ownership/registrar details, nslookup for DNS/IP resolution.**



### DNS Record Types
 • A Record → Returns IPv4 address of a domain.
 • AAAA Record → Returns IPv6 address of a domain.
 • MX Record → Returns Mail Exchange servers responsible for handling email for the domain.


### nslookup Usage

#### Basic IPv4 lookup:
````
nslookup -type=A tryhackme.com
````
<img width="410" height="231" alt="image" src="https://github.com/user-attachments/assets/57608260-011b-4468-ba3b-8bc67406113e" />


#### IPv6 lookup:
````
nslookup -type=AAAA tryhackme.com
````
<img width="460" height="235" alt="image" src="https://github.com/user-attachments/assets/ba35da78-4bca-4622-bd42-135396b0f786" />


#### Mail server lookup:
````
nslookup -type=MX tryhackme.com
````
<img width="688" height="282" alt="image" src="https://github.com/user-attachments/assets/26a37e1a-cdc4-45da-95e8-a0eb68c70a6d" />

- Reveals the domain’s email servers and their configurations.


#### ** Key takeaway: A/AAAA records help map the domain to its IP infrastructure, while MX records reveal email server setups. Together, they expand reconnaissance and highlight possible targets for deeper security assessment.**





### MX Records (Mail Exchange)
- Purpose: MX records specify which mail servers handle email for a domain.
- Example (tryhackme.com):
  - Primary server (priority 1) → aspmx.l.google.com
  - Backup servers → alt1.aspmx.l.google.com, alt2.aspmx.l.google.com
- Behavior:
  - Mail servers attempt delivery to the lowest priority MX first.
  - If unavailable, they move to the next in order.
- Security Note:
  - Google’s servers are well-maintained, so vulnerabilities are unlikely.
  - Other domains may use outdated or misconfigured mail servers, which can be exploitable in penetration testing (if within scope).


### Reconnaissance Value
• MX records reveal email infrastructure.
• Potential attack surfaces:
  • Misconfigured mail servers
  • Weak authentication/encryption
  • Social engineering opportunities (targeting email systems)
• Privacy considerations: WHOIS and DNS often redact sensitive info to prevent abuse.




### Using dig for Advanced Queries
- Definition: `dig` = Domain Information Groper.

#### Basic syntax:
````
dig DOMAIN_NAME
````

#### Specify Record Type:
````
dig DOMAIN_NAME TYPE
````


- Example:
````
dig tryhackme.com MX
````
<img width="872" height="521" alt="image" src="https://github.com/user-attachments/assets/4bd40f4c-6f92-4579-a407-4187da224bc2" />


#### Query Specific DNS Server:
````
dig @SERVER DOMAIN_NAME TYPE
````

- Example using Google DNS:
````
dig @8.8.8.8 tryhackme.com MX
````
<img width="851" height="545" alt="image" src="https://github.com/user-attachments/assets/7879f300-1e7d-4357-adbe-a86b7b14b0d1" />


### **Key Takeaway
• nslookup is simple and quick for basic lookups.
• dig provides more advanced functionality, detailed output, and flexibility in choosing DNS servers.
• Both tools are essential in passive reconnaissance, helping map out infrastructure before moving into deeper penetration testing phases.**





### nslookup vs dig
 • nslookup → Simple, quick, less detailed output.
 • dig → More advanced, includes extra info like TTL (Time To Live) by default, and allows flexible queries.

###  Commands to Run
#### Using nslookup:
````
slookup -type=MX tryhackme.com
````

- - Returns the mail exchange servers for `tryhackme.com`.



#### Using dig (default DNS):
````
dig tryhackme.com MX
````

- Returns MX records with TTL and additional details.


#### Using dig with Cloudflare DNS (1.1.1.1):
````
dig @1.1.1.1 tryhackme.com MX
````

- Queries Cloudflare’s DNS server for MX records of `tryhackme.com`.



### Question 1: Check the TXT records of thmlabs.com. What is the flag there?
<img width="1578" height="205" alt="image" src="https://github.com/user-attachments/assets/87ffc108-9c42-469b-9fd7-c711659548c0" />

````
dig thmlabs.com TXT
````
<img width="967" height="453" alt="image" src="https://github.com/user-attachments/assets/0d199efd-6084-4031-8c0c-7a02c5c1d4ef" />

- Answer: 
````
THM{a5b83929888ed36acb0272971e438d78}
````
<img width="1581" height="209" alt="image" src="https://github.com/user-attachments/assets/c59e2fea-e92a-41ab-a07e-c1fffd742781" />


---




## Task 5: DNSDumster

Tools like nslookup and dig cannot find subdomains by themselves. But subdomains (like `wiki.example.com` or `mail.example.com`) can reveal important information and may even be vulnerable if they are not updated.

To find these hidden subdomains, you can:
- Search the web using many search engines (slow and not always effective).
- Brute-force possible subdomains (time-consuming).
- Use online tools like **DNSDumpster**, which is fast and easy.


DNSDumpster can automatically:

- Discover subdomains (e.g., `blog.tryhackme.com`)
- Show DNS servers
- Show IP addresses and geolocation
- Show MX (mail) records
- Show TXT records
- Present results in tables and graphs

Basically, one DNSDumpster search gives you all DNS-related information about a domain, including hidden subdomains.


- Go to **DNSDumster**: https://dnsdumpster.com/
<img width="1646" height="950" alt="image" src="https://github.com/user-attachments/assets/8a249ce3-2752-4350-aeef-442df7fee7b3" />

- After i search for: `tryhackme.com`
<img width="1489" height="951" alt="image" src="https://github.com/user-attachments/assets/246ddb0a-f432-4a8c-8951-de8435b183e9" />

<img width="1451" height="472" alt="image" src="https://github.com/user-attachments/assets/ff9626ad-bb5e-4131-95cb-a3cbf3738700" />

- Now we see `A record`:
<img width="1300" height="603" alt="image" src="https://github.com/user-attachments/assets/d2229e3b-8407-4d8b-94de-2c35d72474e6" />

- **MX Records**:
<img width="1280" height="359" alt="image" src="https://github.com/user-attachments/assets/465b43da-a23f-4359-8f88-20befcd4e15d" />

- **NS Records** and **TXT Record**:
<img width="1325" height="576" alt="image" src="https://github.com/user-attachments/assets/2823d24d-d82b-41e4-951f-115e32164d10" />

- We can download this diagram:
<img width="1277" height="892" alt="image" src="https://github.com/user-attachments/assets/04051161-a5f1-4c08-bbc6-14ba6396c5ad" />



### Question 1: Lookup tryhackme.com on DNSDumpster. What is one interesting subdomain that you would discover in addition to www and blog?
<img width="1074" height="144" alt="image" src="https://github.com/user-attachments/assets/fadb3441-2406-43b3-a1b4-1bfa3332d221" />

In this first **Subdomain**:
- A subdomain is a part of a larger domain name that helps organize and navigate to different sections of a website or service.
- Basic Structure:
A full website address (URL) often looks like this:
`https://rooms.tryhackme.com`
  - `tryhackme.com` is the main domain (also called the root or primary domain).
  - `rooms` is the subdomain.
  - Together, `rooms.tryhackme.com` is a subdomain of `tryhackme.com`.

- Now we found the discover in addition to www and blog
<img width="1287" height="612" alt="image" src="https://github.com/user-attachments/assets/9b878223-c479-444e-b0a5-7c52b7d15565" />

````
remote
````
<img width="1063" height="140" alt="image" src="https://github.com/user-attachments/assets/a8bf2db0-24d2-4c8f-b8d6-b7b198b542d7" />


---



## Task 5: Shodan.io

### What is shodan.io?
- Shodan.io is a search engine for internet-connected devices (routers, servers, webcams, IoT, etc.), not just websites.

- It allows penetration testers to gather information about a target without directly probing it, reducing the risk of detection.

- **Defensive Use**: Organizations can also use Shodan to monitor their own exposed assets and check what attackers might see.


### How shodan works:
- Shodan scans the internet and attempts to connect to every reachable device.
- When a device responds, Shodan collects:
  - IP address and geolocation
  - Open ports and running services (e.g., HTTP, SSH, FTP)
  - Service banners (software versions, configurations, sometimes even misconfigurations)
  - Metadata (SSL certificates, operating system hints, etc.)
- This data is stored in Shodan’s database and made searchable.


- Direct link: https://www.shodan.io/
- IF I search `tryhackme.com`
<img width="1919" height="972" alt="image" src="https://github.com/user-attachments/assets/0767e458-1460-4fb3-8d73-9a486be91006" />

<img width="1402" height="211" alt="image" src="https://github.com/user-attachments/assets/4ccfd822-e497-41ee-a49d-547280f98fc6" />

- By searching for a domain like tryhackme.com, you can gather information without actively probing the target.
- Information Available from Shodan Records:
  - **IP Address**: The numerical identifier of the server.
  - **Hosting Company**: Which provider or data center hosts the server.
  - **Geographic Location**: Where the server is physically located.
  - **Server Type & Version**: The software running (e.g., Apache, Nginx, OpenVPN) and its version.
- We can also look up IP addresses discovered during DNS lookups, though these may change over time.

---

### Question 1: According to Shodan.io, what is the first country in the world in terms of the number of publicly accessible Apache servers?
<img width="1056" height="93" alt="image" src="https://github.com/user-attachments/assets/9345d27c-599f-4c84-b941-c6fd22d91e18" />

````
product:Apache
````
<img width="1913" height="880" alt="image" src="https://github.com/user-attachments/assets/9f5d35a1-b157-48e2-b6bf-ca819fc8747f" />

- Now we found first country in the world in terms of the number of publicly accessible Apache servers
````
united states
````
<img width="1067" height="95" alt="image" src="https://github.com/user-attachments/assets/113a4c82-7e49-442a-a99f-e2512ed6450e" />


### Question 2: Based on Shodan.io, what is the 3rd most common port used for Apache?
<img width="1068" height="87" alt="image" src="https://github.com/user-attachments/assets/a7bac35a-e346-4536-a2b6-a2fdc9fb09aa" />

````
product:Apache
````
<img width="1916" height="771" alt="image" src="https://github.com/user-attachments/assets/b5283e21-5506-408a-b50b-ee17c68d3082" />


Now we found the 3rd most common port used for Apache
````
8080
````
<img width="1049" height="83" alt="image" src="https://github.com/user-attachments/assets/c3727e0f-f28e-4a36-a1a6-92b8a13dc4b2" />


### Question 3: Based on Shodan.io, what is the 3rd most common port used for nginx?
<img width="1054" height="95" alt="image" src="https://github.com/user-attachments/assets/4813e307-e22a-4770-92c2-67cf37e0148e" />

````
product:nginx
````
<img width="1911" height="770" alt="image" src="https://github.com/user-attachments/assets/8cc8f0ef-136a-41b2-909d-3a1ce9c13cb1" />

Now we found the 3rd most common port used for nginx:
````
888
````
<img width="1267" height="621" alt="image" src="https://github.com/user-attachments/assets/29042713-7b9f-4cf7-a228-d455717fc90f" />



---



## Task 7: Summery
summary table of the passive reconnaissance tools and commands shown:
| **Purpose**                                 | **Tool**   | **Command Example**                       |
| ------------------------------------------- | ---------- | ----------------------------------------- |
| Lookup WHOIS record                         | `whois`    | `whois tryhackme.com`                     |
| Lookup DNS A records                        | `nslookup` | `nslookup -type=A tryhackme.com`          |
| Lookup DNS MX records (specific DNS server) | `nslookup` | `nslookup -type=MX tryhackme.com 1.1.1.1` |
| Lookup DNS TXT records                      | `nslookup` | `nslookup -type=TXT tryhackme.com`        |
| Lookup DNS A records                        | `dig`      | `dig tryhackme.com A`                     |
| Lookup DNS MX records (specific DNS server) | `dig`      | `dig @1.1.1.1 tryhackme.com MX`           |
| Lookup DNS TXT records                      | `dig`      | `dig tryhackme.com TXT`                   |


---

We got successful:
![Uploading image.png…]()



---

<h2 align=center> Finished of Passive Reconnaissance </h2>


<h2 align="center"> Credit by: Nin Kanong (k4n0ng) </h2>

<h3 align="center"> Date: 24/12/2025 </h3>







